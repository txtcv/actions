name: validate-json-resume-cv
description: Validate a JSON resume CV file

inputs:
  cv-path:
    description: "Relative path to the CV JSON file to validate."
    required: false
    default: "cv.json"

runs:
  using: "composite"
  steps:
    - id: install
      name: Install
      shell: bash
      run: |
        set -euo pipefail

        if ! command -v brew >/dev/null 2>&1; then
          echo 'Homebrew (brew) must be available on the runner to install txtcv.' >&2
          exit 1
        fi

        brew tap txtcv/tap
        brew install --quiet txtcv

    - name: Validate
      shell: bash
      env:
        CV_PATH: ${{ inputs['cv-path'] }}
      run: |
        set -euo pipefail

        if [[ ! -f "$CV_PATH" ]]; then
          echo "CV file '$CV_PATH' was not found." >&2
          exit 1
        fi

        txtcv validate "$CV_PATH"
